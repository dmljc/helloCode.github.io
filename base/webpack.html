<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack | Hello Code</title>
    <meta name="description" content=" ">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.3c6340de.css" as="style"><link rel="preload" href="/assets/js/app.13f7f72b.js" as="script"><link rel="preload" href="/assets/js/2.8bf05cb3.js" as="script"><link rel="preload" href="/assets/js/15.71d46fae.js" as="script"><link rel="prefetch" href="/assets/js/10.8bebb348.js"><link rel="prefetch" href="/assets/js/11.913af1ee.js"><link rel="prefetch" href="/assets/js/12.c675867c.js"><link rel="prefetch" href="/assets/js/13.46800553.js"><link rel="prefetch" href="/assets/js/14.e395c1f7.js"><link rel="prefetch" href="/assets/js/16.a6c58972.js"><link rel="prefetch" href="/assets/js/17.a954c160.js"><link rel="prefetch" href="/assets/js/18.87b2e95c.js"><link rel="prefetch" href="/assets/js/19.3f486f4d.js"><link rel="prefetch" href="/assets/js/20.8a0c2b77.js"><link rel="prefetch" href="/assets/js/21.a2079b54.js"><link rel="prefetch" href="/assets/js/3.fa963c5f.js"><link rel="prefetch" href="/assets/js/4.183c4edd.js"><link rel="prefetch" href="/assets/js/5.e363be55.js"><link rel="prefetch" href="/assets/js/6.cbca80e7.js"><link rel="prefetch" href="/assets/js/7.0b458db0.js"><link rel="prefetch" href="/assets/js/8.ae74a92a.js"><link rel="prefetch" href="/assets/js/9.e6d88331.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3c6340de.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Hello Code</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/base/js.html" class="nav-link">前端技能</a></div><div class="nav-item"><a href="/optimize/optim.html" class="nav-link">性能优化</a></div><div class="nav-item"><a href="/linux/linux.html" class="nav-link">Linux</a></div><div class="nav-item"><a href="/interview/inter.html" class="nav-link">面试宝典</a></div><div class="nav-item"><a href="http://common-vue.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Common-Vue
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/base/js.html" class="nav-link">前端技能</a></div><div class="nav-item"><a href="/optimize/optim.html" class="nav-link">性能优化</a></div><div class="nav-item"><a href="/linux/linux.html" class="nav-link">Linux</a></div><div class="nav-item"><a href="/interview/inter.html" class="nav-link">面试宝典</a></div><div class="nav-item"><a href="http://common-vue.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Common-Vue
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/base/js.html" class="sidebar-link">基础阶段</a></li><li><a href="/base/css.html" class="sidebar-link">CSS 模块</a></li><li><a href="/base/browser.html" class="sidebar-link">浏览器篇</a></li><li><a href="/base/vue.html" class="sidebar-link">前端框架</a></li><li><a href="/base/git.html" class="sidebar-link">工具 Git</a></li><li><a href="/base/webpack.html" class="active sidebar-link">Webpack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/base/webpack.html#基础篇章" class="sidebar-link">基础篇章</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/base/webpack.html#entry" class="sidebar-link">Entry</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#output" class="sidebar-link">Output</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#loaders" class="sidebar-link">Loaders</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#plugins" class="sidebar-link">Plugins</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#mode" class="sidebar-link">Mode</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#解析es6" class="sidebar-link">解析ES6</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#解析-css-less-sass" class="sidebar-link">解析 CSS Less Sass</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#解析图片-字体" class="sidebar-link">解析图片 字体</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#文件监听" class="sidebar-link">文件监听</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#热更新-wds" class="sidebar-link">热更新 WDS</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#热更新-wdm" class="sidebar-link">热更新 WDM</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#文件指纹" class="sidebar-link">文件指纹</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#js-文件压缩" class="sidebar-link">JS 文件压缩</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#css⽂件压缩" class="sidebar-link">CSS⽂件压缩</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#html-文件压缩" class="sidebar-link">Html 文件压缩</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#设置环境变量" class="sidebar-link">设置环境变量</a></li></ul></li><li class="sidebar-sub-header"><a href="/base/webpack.html#进阶一篇" class="sidebar-link">进阶一篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/base/webpack.html#构建的问题" class="sidebar-link">构建的问题</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#autoprefixer" class="sidebar-link">autoprefixer</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#css3-响应式布局" class="sidebar-link">CSS3 响应式布局</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#内联" class="sidebar-link">内联</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#多页打包通用方案" class="sidebar-link">多页打包通用方案</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#基础库分离" class="sidebar-link">基础库分离</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#code-splitting" class="sidebar-link">Code Splitting</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#tree-shaking" class="sidebar-link">Tree Shaking</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#懒加载-js" class="sidebar-link">懒加载 JS</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#eslint" class="sidebar-link">Eslint</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#优化命令行的构建⽇志" class="sidebar-link">优化命令行的构建⽇志</a></li></ul></li><li class="sidebar-sub-header"><a href="/base/webpack.html#进阶二篇" class="sidebar-link">进阶二篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/base/webpack.html#速度分析" class="sidebar-link">速度分析</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#分析体积" class="sidebar-link">分析体积</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#使用高版本-webpack-和-node" class="sidebar-link">使用高版本 webpack 和 Node</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#多进程-happypack" class="sidebar-link">多进程 HappyPack</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#多进程-thread-loader" class="sidebar-link">多进程 thread-loader</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#多进程-并行压缩" class="sidebar-link">多进程 并行压缩</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#缓存" class="sidebar-link">缓存</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#缩小构建目标" class="sidebar-link">缩小构建目标</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#减少文件搜索范围" class="sidebar-link">减少文件搜索范围</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#图片压缩" class="sidebar-link">图片压缩</a></li></ul></li><li class="sidebar-sub-header"><a href="/base/webpack.html#提升体验" class="sidebar-link">提升体验</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/base/webpack.html#progress-bar-webpack-plugin" class="sidebar-link">progress-bar-webpack-plugin</a></li><li class="sidebar-sub-header"><a href="/base/webpack.html#webpack-build-notifier" class="sidebar-link">webpack-build-notifier</a></li></ul></li><li class="sidebar-sub-header"><a href="/base/webpack.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/base/wechat.html" class="sidebar-link">小程序篇</a></li><li><a href="/base/safety.html" class="sidebar-link">安全相关</a></li><li><a href="/base/node.html" class="sidebar-link">Node模块</a></li><li><a href="/base/algorithm.html" class="sidebar-link">算法基础</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack"><a href="#webpack" class="header-anchor">#</a> Webpack</h1> <h2 id="基础篇章"><a href="#基础篇章" class="header-anchor">#</a> 基础篇章</h2> <p>本质上，webpack 是一个现代 JavaScript 应用程序的静态模块打包器(module bundler)。当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。</p> <p><img src="https://t1.picb.cc/uploads/2019/09/09/gXSVgg.png" alt=""></p> <h3>优势</h3> <ul><li>社区生态丰富</li> <li>配置灵活和插件化扩展</li> <li>官方更新迭代速度快</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack 配置组成</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>    <span class="token comment">// 打包的⼊入⼝口⽂文件</span>
    output<span class="token punctuation">:</span> <span class="token string">'./dist/main.js'</span><span class="token punctuation">,</span>   <span class="token comment">// 打包输出</span>
    mode<span class="token punctuation">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>     <span class="token comment">// 环境</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            test<span class="token punctuation">:</span> <span class="token regex">/\.txt$/</span><span class="token punctuation">,</span>     <span class="token comment">// loader 配置</span>
            use<span class="token punctuation">:</span> <span class="token string">'raw-loader'</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlwebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>     <span class="token comment">// 插件配置</span>
            template<span class="token punctuation">:</span> <span class="token string">'./src/index.html'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>webpack 安装过程省略，请自行 chrome。</p> <h3 id="entry"><a href="#entry" class="header-anchor">#</a> Entry</h3> <p>Entry⽤来指定webpack的打包⼊口。对于非代码比如图片、字体依赖也会不断加⼊到依赖图中。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 单⼊口：entry是⼀个字符串</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token string">'./path/to/my/entry/file.js'</span>
<span class="token punctuation">}</span>

<span class="token comment">// 多⼊口：entry是⼀个对象</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        app<span class="token punctuation">:</span> <span class="token string">'./src/app.js'</span><span class="token punctuation">,</span>
        adminApp<span class="token punctuation">:</span> <span class="token string">'./src/adminApp.js'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="output"><a href="#output" class="header-anchor">#</a> Output</h3> <p>Output ⽤来告诉 webpack 如何将编译后的⽂件输出到磁盘。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 单⼊口配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token string">'./path/to/my/entry/file.js'</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        filename<span class="token punctuation">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
        path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">'/dist'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 多入口配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        app<span class="token punctuation">:</span> <span class="token string">'./src/app.js'</span><span class="token punctuation">,</span>
        search<span class="token punctuation">:</span> <span class="token string">'./src/search.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        filename<span class="token punctuation">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>    <span class="token comment">// 通过占位符确保文件名称的唯⼀</span>
        path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">'/dist'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="loaders"><a href="#loaders" class="header-anchor">#</a> Loaders</h3> <p>Webpack 开箱即用只支持 JS 和 JSON 两种文件类型，通过 Loaders 去支持其它文件类型并且把它们转化成有效的模块，
并且可以添加到依赖图中。本身是一个函数，接受源文件作为参数，返回转换的结果。</p> <table><thead><tr><th>名称</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td>babel-loader</td> <td style="text-align:left;">转换 ES6、ES7 等 JS 新特性语法</td></tr> <tr><td>css-loader</td> <td style="text-align:left;">支持 .css 文件的加载和解析</td></tr> <tr><td>style-loader</td> <td style="text-align:left;">把 js 中引入的 css 内容 注入到 html 标签中，并添加 style 标签. 依赖 css-loader</td></tr> <tr><td>less-loader</td> <td style="text-align:left;">将 less 文件转换为 css 文件</td></tr> <tr><td>file-loader</td> <td style="text-align:left;">图片，字体的转换</td></tr> <tr><td>url-loader</td> <td style="text-align:left;">类似于 file-loader，能把 url 地址对应的文件，打包成 base64 格式，提高访问效率</td></tr> <tr><td>thread-loader</td> <td style="text-align:left;">多进程打包 js 和 css</td></tr></tbody></table> <h3>Loaders的⽤用法</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        filename<span class="token punctuation">:</span> <span class="token string">'bundle.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span> 
                test<span class="token punctuation">:</span> <span class="token regex">/\.txt$/</span><span class="token punctuation">,</span>     <span class="token comment">// test 指定匹配规则 use 指定使用的loader名称</span>
                use<span class="token punctuation">:</span> <span class="token string">'raw-loader'</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="plugins"><a href="#plugins" class="header-anchor">#</a> Plugins</h3> <p>插件⽤于 bundle ⽂件的优化，资源管理和环境变量注入，作用于整个构建过程。</p> <h3>常见的Plugins有哪些？</h3> <table><thead><tr><th>名称</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td>SplitChunksPlugin</td> <td style="text-align:left;">将 chunks 相同的模块代码提取为公共的js</td></tr> <tr><td>CleanWebpackPlugin</td> <td style="text-align:left;">清理构建目录</td></tr> <tr><td>MiniCssExtractPlugin</td> <td style="text-align:left;">将 css 从 bundle 文件提取为独立的 css文件</td></tr> <tr><td>HtmlWebpackPlugin</td> <td style="text-align:left;">创建 html 文件 并自动把打包后的 CSS 或者JS 文件直接注入到 HTML 模板中</td></tr> <tr><td>UglifyjsWebpackPlugin</td> <td style="text-align:left;">压缩 js</td></tr> <tr><td>ZipWebpackPlugin</td> <td style="text-align:left;">把打包出的资源压缩为 .zip 文件</td></tr></tbody></table> <h3>Plugins的⽤用法</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        filename<span class="token punctuation">:</span> <span class="token string">'bundle.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            template<span class="token punctuation">:</span> <span class="token string">'./src/index.html'</span>    <span class="token comment">// 放到 plugins 数组里</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>   
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="mode"><a href="#mode" class="header-anchor">#</a> Mode</h3> <p>通过 <strong>process.env.NODE_ENV</strong> 来指定当前的构建环境是：production、development 还是 none，默认值为 production。</p> <h3 id="解析es6"><a href="#解析es6" class="header-anchor">#</a> 解析ES6</h3> <p>使⽤ babel-loader， babel 的配置⽂件是：.babelrc</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">:</span> <span class="token punctuation">{</span>    
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
            use<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> 

<span class="token comment">// .babelrc 文件</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;presets&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>     <span class="token comment">// 此行为增加 ES6 的babel preset 配置</span>
        <span class="token string">&quot;@babel/preset-react&quot;</span>    <span class="token comment">// 解析React JSX 增加 React 的babel preset 配置</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;plugins&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;@babel/proposal-class-properties&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="解析-css-less-sass"><a href="#解析-css-less-sass" class="header-anchor">#</a> 解析 CSS Less Sass</h3> <p>css-loader ⽤于加载 .css 文件，并且转换成 commonjs 对象，style-loader 将样式通过 <code>&lt;style&gt;</code> 标签插⼊到 head 中。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
        <span class="token comment">// test: /\.less$/,    // 解析 less 时候匹配 </span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
            <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
            <span class="token string">'less-loader'</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="解析图片-字体"><a href="#解析图片-字体" class="header-anchor">#</a> 解析图片 字体</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpg|jpeg|gif|svg｜woff|woff2|eot|ttf|otf)$/</span><span class="token punctuation">,</span> 
        <span class="token comment">// use: [</span>
        <span class="token comment">//     'file-loader'</span>
        <span class="token comment">// ],</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>   <span class="token comment">// url-loader 也可以处理图片和字体，可以设置较小资源为 base64 格式</span>
                options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    limit<span class="token punctuation">:</span> <span class="token number">1024</span>  <span class="token comment">// 单位字节 B，1KB = 1024B</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="文件监听"><a href="#文件监听" class="header-anchor">#</a> 文件监听</h3> <p>文件监听是发现源码变化时，自动重新构建出新的输出⽂件。webpack 开启监听模式，有两种⽅式：</p> <ul><li>package.json 文件的 script 中添加 &quot;watch&quot;: &quot;wabpack --watch&quot;</li> <li>在配置 webpack.config.js 中设置 watch: true</li></ul> <h3>文件监听原理分析</h3> <p>轮询判断文件的最后编辑时间是否变化，某个文件发生了变化，并不会⽴刻告诉监听者，而是先缓存起来，等aggregateTimeout。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 默认false，也就是不开启</span>
    watch<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 只有开启监听模式时，watchOptions才有意义</span>
    wathcOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 默认为空，不监听的文件或者文件夹，支持正则匹配</span>
        ignored<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        <span class="token comment">// 监听到变化发生后会等300ms再去执行，默认300ms</span>
        aggregateTimeout<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
        <span class="token comment">// 判断文件是否发生变化是通过不停询问系统指定文件有没有变化实现的，默认每秒问1000次</span>
        poll<span class="token punctuation">:</span> <span class="token number">1000</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>唯一缺陷：每次需要手动刷新浏览器器。当然，可以通过 webpack-dev-server 不刷新页面而自动构建。</strong></p> <h3 id="热更新-wds"><a href="#热更新-wds" class="header-anchor">#</a> 热更新 WDS</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// package.json</span>
<span class="token string">&quot;script&quot;</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;dev&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;webpack-dev-server --open&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>WDS 热更新 不刷新浏览器</li> <li>WDS 不输出文件，⽽是放在内存中使用 HotModuleReplacementPlugin 插件</li></ul> <h3 id="热更新-wdm"><a href="#热更新-wdm" class="header-anchor">#</a> 热更新 WDM</h3> <p>WDM (webpack-dev-middleware) 将 webpack 输出的文件传输给服务器，适用于灵活的定制场景。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackDevMiddleware <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-dev-middleware'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">webpackDevMiddleware</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    publicPath<span class="token punctuation">:</span> config<span class="token punctuation">.</span>output<span class="token punctuation">.</span>publicPath
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Example app listening on port 3000!\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>热更新的原理分析:</p> <ul><li>Webpack Compile: 将 JS 编译成 Bundle</li> <li>HMR Server: 将热更新的文件输出给 HMR Rumtime</li> <li>Bundle server: 提供文件在浏览器的访问</li> <li>HMR Rumtime: 会被注入到浏览器，更新文件的变化</li> <li>bundle.js: 构建输出的⽂件</li></ul> <h3 id="文件指纹"><a href="#文件指纹" class="header-anchor">#</a> 文件指纹</h3> <p>打包后输出的文件名的后缀（hash，默认是由 md5 生成）。</p> <h3>文件指纹如何生成？</h3> <ul><li>Hash：和整个项目的构建相关，只要项目文件有修改，整个项⽬构建的 hash 值就会更改；</li> <li>Chunkhash：和 webpack 打包的 chunk 有关，不同的 entry 会生成不同的 chunkhash 值；</li> <li>Contenthash：根据文件内容来定义 hash ，文件内容不变，则 contenthash 不变；</li></ul> <h3>文件指纹的设置：</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// JS 的文件指纹设置 output 的 filename，使用 [chunkhash]</span>
output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name][chunkhash:8].js'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">'/dist'</span>
<span class="token punctuation">}</span>

<span class="token comment">// CSS的文件指纹设置 MiniCssExtractPlugin 的 filename，使用 [contenthash]</span>
plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        filename<span class="token punctuation">:</span> <span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">[</span>contenthash<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">.</span>css
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">]</span>

<span class="token comment">// 图片的⽂件指纹设置 设置file-loader 的name，使用 [hash]</span>
rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpg|jpeg|gig|svg).$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">&quot;file-loader&quot;</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                name<span class="token punctuation">:</span> <span class="token string">&quot;img/[name][hash:8].[ext]&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="js-文件压缩"><a href="#js-文件压缩" class="header-anchor">#</a> JS 文件压缩</h3> <p>Webpack4 内置了 uglifyjs-webpack-plugin 插件。但是，我们可以根据官方提供的参数优化 JS 压缩。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            test<span class="token punctuation">:</span> <span class="token regex">/\.js(\?.*)?$/i</span><span class="token punctuation">,</span>  <span class="token comment">// 测试匹配文件</span>
            include<span class="token punctuation">:</span> <span class="token regex">/\/includes/</span><span class="token punctuation">,</span>  <span class="token comment">// 包含哪些文件</span>
            excluce<span class="token punctuation">:</span> <span class="token regex">/\/excludes/</span><span class="token punctuation">,</span>  <span class="token comment">// 不包含哪些文件</span>

            <span class="token comment">// 允许过滤哪些块应该被 uglified（默认情况下，所有块都是 uglified）。 </span>
            <span class="token comment">// 返回 true 以 uglify 块，否则返回 false。</span>
            <span class="token function-variable function">chunkFilter</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// `vendor` 模块不压缩</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>chunk<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'vendor'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    
        cache<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>   <span class="token comment">// 是否启用文件缓存，默认缓存在node_modules/.cache/uglifyjs-webpack-plugin.目录</span>
        parallel<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token comment">// 使用多进程并行运行来提高构建速度，强烈建议使用</span>
        sourceMap<span class="token punctuation">:</span> <span class="token boolean">true</span>  <span class="token comment">// 使用源映射将错误消息位置映射到模块（这会减慢编译速度）</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="css⽂件压缩"><a href="#css⽂件压缩" class="header-anchor">#</a> CSS⽂件压缩</h3> <p>使用 optimize-css-assets-webpack-plugin 同时使用 cssnano优化器。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        assetNameRegExp<span class="token punctuation">:</span> <span class="token regex">/\.css$/g</span><span class="token punctuation">,</span>
        cssProcessor<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="html-文件压缩"><a href="#html-文件压缩" class="header-anchor">#</a> Html 文件压缩</h3> <p>修改 html-webpack-plugin，设置压缩参数。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/search.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token punctuation">:</span> <span class="token string">'search.html'</span><span class="token punctuation">,</span><span class="token operator">+</span>chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'search'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        html5<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        removeComments<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>       <span class="token comment">// 移除HTML中的注释</span>
        removeAttributeQuotes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否移除属性的引号 默认false</span>
        collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>   <span class="token comment">// 删除空白符与换行符</span>
        minifyCSS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token comment">// 压缩内联css</span>
        minifyJS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>             <span class="token comment">// 是否压缩html里的js（使用uglify-js进行的压缩）</span>
        removeEmptyAttributes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否删除空属性，默认false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="设置环境变量"><a href="#设置环境变量" class="header-anchor">#</a> 设置环境变量</h3> <p>DefinePlugin 允许我们创建全局变量，可以在编译时进行设置，用来区分 开发环境 和 正式环境 或者其他环境（测试环境）。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'process.env'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token constant">VUEP_BASE_URL</span><span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">'http://localhost:9000'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="进阶一篇"><a href="#进阶一篇" class="header-anchor">#</a> 进阶一篇</h2> <h3 id="构建的问题"><a href="#构建的问题" class="header-anchor">#</a> 构建的问题</h3> <p>每次构建的时候不会清理⽬录，造成构建的输出目录 output 文件越来越多。</p> <p>常用解决方案无非以下两种：</p> <ul><li><p>通过 npm scripts 清理构建⽬录</p> <ul><li>rm -rf./dist &amp;&amp; webpack</li> <li>rimraf./dist &amp;&amp; webpack</li></ul></li> <li><p>⾃动清理构建⽬录 clean-webpack-plugin</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 每次构建时候 默认会先删除 output 指定的输出目录</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="autoprefixer"><a href="#autoprefixer" class="header-anchor">#</a> autoprefixer</h3> <p>因为各大浏览器的标准不一致，导致 CSS3 新增属性要添加前缀才能解决 CSS 兼容性问题。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 在自动化工具没出来之前，大家都是手动的添加 CSS 前缀 耗时有费力</span>
<span class="token punctuation">.</span>box <span class="token punctuation">{</span>
    <span class="token operator">-</span>moz<span class="token operator">-</span>border<span class="token operator">-</span>radius<span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>    <span class="token comment">// 火狐浏览器</span>
    <span class="token operator">-</span>webkit<span class="token operator">-</span>border<span class="token operator">-</span>radius<span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>    <span class="token comment">// chrome</span>
    <span class="token operator">-</span>o<span class="token operator">-</span>border<span class="token operator">-</span>radius<span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>     <span class="token comment">// 欧朋浏览器</span>
    border<span class="token operator">-</span>radius<span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>现在 可以使用 PostCSS 插件 autoprefixer ⾃动补齐 CSS3 前缀。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
            <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
            <span class="token string">'less-loader'</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                loader<span class="token punctuation">:</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
                options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token function-variable function">plugins</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
                        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                            browsers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;last 2 version&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&gt; 1%&quot;</span><span class="token punctuation">,</span>  <span class="token string">&quot;iOS 7&quot;</span><span class="token punctuation">]</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="css3-响应式布局"><a href="#css3-响应式布局" class="header-anchor">#</a> CSS3 响应式布局</h3> <p>起初，我们都是通过 CSS 媒体查询实现响应式布局。缺陷：需要写多套适配样式代码。如下所示：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>@media screen <span class="token function">and</span> <span class="token punctuation">(</span><span class="token parameter">max<span class="token operator">-</span>width<span class="token punctuation">:</span> <span class="token number">980</span>px</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span>header <span class="token punctuation">{</span>
        width<span class="token punctuation">:</span> <span class="token number">900</span>px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
@media screen <span class="token function">and</span> <span class="token punctuation">(</span><span class="token parameter">max<span class="token operator">-</span>width<span class="token punctuation">:</span> <span class="token number">480</span>px</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span>header <span class="token punctuation">{</span>
        height<span class="token punctuation">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
@media screen <span class="token function">and</span> <span class="token punctuation">(</span><span class="token parameter">max<span class="token operator">-</span>width<span class="token punctuation">:</span> <span class="token number">350</span>px</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span>header <span class="token punctuation">{</span>
        height<span class="token punctuation">:</span> <span class="token number">300</span>px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>为了弥补 @media 的缺陷，rem 布局应运而生。</p> <p>rem 和 px 的对⽐：</p> <ul><li>rem 是相对单位，相对于跟元素 html</li> <li>px 是绝对单位 （如果css里面没有设定 html 的 font-size，则默认浏览器以 1rem = 16px 来换算）</li></ul> <p>但是，使用了 rem 布局之后，css 就需要 px 转为 rem 单位了。我们需要手动的把 px 转为 rem，无形之中影响了开发效率。
伟大的天朝人民从来不让人失望，px2rem-loader 的问世，解决了这个问题。它可以在⻚面渲染时计算根元素的 font-size 值。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span>   
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
            <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
            <span class="token string">'less-loader'</span>
            <span class="token punctuation">{</span>
                loader<span class="token punctuation">:</span> <span class="token string">&quot;px2rem-loader&quot;</span><span class="token punctuation">,</span>
                options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    remUnit<span class="token punctuation">:</span> <span class="token number">75</span><span class="token punctuation">,</span>    <span class="token comment">// remUnit 为 1rem = 75px，</span>
                    remPrecision<span class="token punctuation">:</span> <span class="token number">8</span>   <span class="token comment">// remPrecision 为转化后小数点后位数</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="内联"><a href="#内联" class="header-anchor">#</a> 内联</h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code>raw-loader 内联html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">$<span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">' raw-loader!babel-loader!. /meta.html'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

raw-loader 内联JS
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">$<span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'raw-loader!babel-loader!../node_modules/lib-flexible'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>css 内联</p> <ul><li>借助 style-loader</li> <li>html-inline-css-webpack-plugin</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    loader<span class="token punctuation">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        insertAt<span class="token punctuation">:</span> <span class="token string">'top'</span><span class="token punctuation">,</span> <span class="token comment">// 样式插入到&lt;head&gt;</span>
        singleton<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 将所有的style标签合并成一个</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="多页打包通用方案"><a href="#多页打包通用方案" class="header-anchor">#</a> 多页打包通用方案</h3> <p>思路：利用 glob.sync，动态获取 entry 和设置 html-webpack-plugin 数量。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'glob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">setMPA</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> entry <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> htmlWebpackPlugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> entryFiles <span class="token operator">=</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/*/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>entryFiles<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> entryFile <span class="token operator">=</span> entryFiles<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> match <span class="token operator">=</span> entryFile<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/src\/(.*)\/index\.js/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> pageName <span class="token operator">=</span> match <span class="token operator">&amp;&amp;</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            entry<span class="token punctuation">[</span>pageName<span class="token punctuation">]</span> <span class="token operator">=</span> entryFile<span class="token punctuation">;</span>
            htmlWebpackPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    inlineSource<span class="token punctuation">:</span> <span class="token string">'.css$'</span><span class="token punctuation">,</span>
                    template<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    filename<span class="token punctuation">:</span> `$<span class="token punctuation">{</span>pageName<span class="token punctuation">}</span><span class="token punctuation">.</span>html`<span class="token punctuation">,</span>
                    chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'vendors'</span><span class="token punctuation">,</span> pageName<span class="token punctuation">]</span><span class="token punctuation">,</span>
                    inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        html5<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        preserveLineBreaks<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                        minifyCSS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        minifyJS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        removeComments<span class="token punctuation">:</span> <span class="token boolean">false</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        entry<span class="token punctuation">,</span>
        htmlWebpackPlugins
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> entry<span class="token punctuation">,</span> htmlWebpackPlugins <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">setMPA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> entry<span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span> <span class="token string">'[name]_[chunkhash:8].js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mode<span class="token punctuation">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>htmlWebpackPlugins<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h3 id="基础库分离"><a href="#基础库分离" class="header-anchor">#</a> 基础库分离</h3> <h3>方案1: externals</h3> <ul><li>如果我们想引用一个库，但是又不想让 webpack 打包，并且又不影响我们在项目中使用,可以配置 Externals 解决。</li> <li>使用 html-webpack-externals-plugin</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">HtmlWebpackExternalsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    externals<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            module<span class="token punctuation">:</span> <span class="token string">'react'</span><span class="token punctuation">,</span>
            entry<span class="token punctuation">:</span> <span class="token string">'https://11.url.cn/now/lib/16.2.0/react.min.js'</span><span class="token punctuation">,</span>
            global<span class="token punctuation">:</span> <span class="token string">'React'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            module<span class="token punctuation">:</span> <span class="token string">'react-dom'</span><span class="token punctuation">,</span>
            entry<span class="token punctuation">:</span> <span class="token string">'https://11.url.cn/now/lib/16.2.0/react-dom.min.js'</span><span class="token punctuation">,</span>
            global<span class="token punctuation">:</span> <span class="token string">'ReactDOM'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3>方案2: DllPlugin</h3> <p>对于开发项目中不经常会变更的第三方模块。类似于我们的 elementUi、vue 全家桶等等。因为很少会变更，所以我们不希望这些依赖要被集成到每一次的构建逻辑中去。 这样做的好处是每次更改我本地代码的文件的时候，webpack 只需要打包我项目本身的文件代码，而不会再去编译第三方库。以后只要我们不升级第三方包，那么webpack 就不会对这些库去打包，这样可以快速的提高打包的速度。</p> <p>使用 webpack 内置的 DllPlugin、DllReferencePlugin 进行抽离。在与 webpack 配置文件同级目录下新建 webpack.dll.config.js 代码如下：</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token comment">// webpack.dll.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        vendor<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'vue'</span><span class="token punctuation">,</span> <span class="token string">'vuex'</span><span class="token punctuation">,</span> <span class="token string">'vue-router'</span><span class="token punctuation">,</span> <span class="token string">'element-ui'</span><span class="token punctuation">]</span>  <span class="token comment">// 想要打包的模块</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'static/js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 打包后文件输出的位置</span>
        filename<span class="token punctuation">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>
        library<span class="token punctuation">:</span> <span class="token string">'[name]_library'</span> 
        <span class="token comment">// 这里需要和 webpack.DllPlugin 中的 `name: '[name]_library',` 保持一致。</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'[name]-manifest.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">'[name]_library'</span><span class="token punctuation">,</span> 
            context<span class="token punctuation">:</span> __dirname
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>在 package.json 中配置如下命令:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">&quot;dll&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;webpack --config build/webpack.dll.config.js&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>接下来在 webpack.config.js 中增加以下代码:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            context<span class="token punctuation">:</span> __dirname<span class="token punctuation">,</span>
            manifest<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./vendor-manifest.json'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>  <span class="token comment">// 拷贝生成的文件到dist目录 这样每次不必手动去cv</span>
            <span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token string">'static'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span><span class="token string">'static'</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>执行:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm run dll
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>生成了集合第三地方代码的 vendor.dll.js。但是，需要在 html 文件中手动引入这个js文件:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;ie=edge&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>老yuan<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;static/js/vendor.dll.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>   <span class="token comment">// 手动引入这个js文件</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>如果我们没有更新第三方依赖包，就不必 npm run dll。直接执行 npm run dev、 npm run build 的时候打包速度明显有提升。
因为我们已经通过 dllPlugin 将第三方依赖包抽离出来了。</p> <h3 id="code-splitting"><a href="#code-splitting" class="header-anchor">#</a> Code Splitting</h3> <p>对于⼤的Web应用来讲，将所有的代码都放在一个⽂件中显然是不够有效的，特别是当你的某些代码块是在某些特殊的时候才会被使⽤到。
webpack 的 code splitting 的功能就是将你的代码库分割成 chunks（语块），当代码运行到需要它们的时候再进⾏加载。</p> <p>三种常见的代码分离方法：</p> <ul><li>入口起点：使用entry配置，手动的分离代码</li> <li>防止重复：使用 SplitChunksPlugin 去重和分离 chunk</li> <li><a href="https://webpack.js.org/guides/code-splitting/#root" target="_blank" rel="noopener noreferrer">动态导入：通过模块的内联函数调用来分离代码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>如上所述，方法一存在缺陷：</p> <ul><li>如果输入块之间存在任何重复的模块，则它们将包含在两个包中。</li> <li>它不够灵活，不能用于使用核心应用程序逻辑动态分割代码。</li></ul> <p>PS：为了解决上述缺陷，我么使用 SplitChunksPlugin 删除重复。</p> <p>该插件在 Webpack4 已经内置，用来替代 CommonsChunkPlugin 插件。</p> <p>chunks参数说明：</p> <ul><li>async 异步引入的库进行分离(默认)</li> <li>initial 同步引⼊的库进行分离</li> <li>all 所有引⼊的库进行分离(推荐)</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        chunks<span class="token punctuation">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span> 
        minSize<span class="token punctuation">:</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token comment">// 表示在压缩前的最小模块大小，默认为30000</span>
        minChunks<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>   <span class="token comment">// 表示被引用次数，默认为1</span>
        maxAsyncRequests<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>   <span class="token comment">// 按需加载时候最大的并行请求数，默认为5</span>
        maxInitialRequests<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token comment">// 一个入口最大的并行请求数，默认为3</span>
        automaticNameDelimiter<span class="token punctuation">:</span> <span class="token string">'~'</span><span class="token punctuation">,</span>   <span class="token comment">// 命名连接符</span>
        name<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>     <span class="token comment">// 拆分出来块的名字，默认由块名和hash值自动生成</span>
        cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 缓存组的属性 reuseExistingChunk </span>
                        <span class="token comment">// 如果当前代码块包含的模块已经有了，就不在产生一个新的代码块</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="tree-shaking"><a href="#tree-shaking" class="header-anchor">#</a> Tree Shaking</h3> <p>App 往往有一个入口文件，相当于一棵树的主干，入口文件有很多依赖的模块，相当于树枝。实际情况中，虽然依赖了某个模块，
但其实只使用其中的某些功能。通过 Tree shaking，将没有使用的模块摇掉，这样来达到删除无用代码的目的。</p> <blockquote><p>这里单独提一下tree-shaking,是因为这里有个坑。tree-shaking的主要作用是用来清除代码中无用的部分。目前在webpack4 我们设置mode为production的时候已经自动开启了tree-shaking。但是要想使其生效，生成的代码必须是ES6模块。不能使用其它类型的模块如CommonJS之流。如果使用Babel的话，这里有一个小问题，因为Babel的预案（preset）默认会将任何模块类型都转译成CommonJS类型，这样会导致tree-shaking失效。修正这个问题也很简单，在.babelrc文件或在webpack.config.js文件中设置modules：false  就好了。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// .babelrc</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;presets&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;modules&quot;</span><span class="token punctuation">:</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>或者：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
            use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> modules<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>，
            exclude<span class="token punctuation">:</span> <span class="token regex">/(node_modules)/</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>Tree-shaking 原理：</p> <p>利⽤ ES6 模块的特点:</p> <ul><li>只能作为模块顶层的语句出现</li> <li>import 的模块名只能是字符串常量</li> <li>import binding 是 immutable的</li></ul> <p>注意：冗余代码是在 uglify 阶段删除的。</p> <h3 id="懒加载-js"><a href="#懒加载-js" class="header-anchor">#</a> 懒加载 JS</h3> <ul><li>CommonJS：require.ensure</li> <li>ES6 动态 import（⽬前还没有原生⽀持，需要babel转换，如下）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;plugins&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;@babel/plugin-syntax-dynamic-import&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="eslint"><a href="#eslint" class="header-anchor">#</a> Eslint</h3> <p>Eslint 帮助保持团队的代码⻛格统一。但是，不建议造轮子，可以直接引用 <a href="https://github.com/AlloyTeam/eslint-config-alloy" target="_blank" rel="noopener noreferrer">腾讯团队 eslint 规范<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h3>方案一：本地开发阶段增加 precommit 钩⼦</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 安装 husky npm install husky --save-dev</span>
<span class="token comment">// 增加 npm script，通过 lint-staged 增量检查修改的文件 </span>

<span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;precommit&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;lint-staged&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token string">&quot;lint-staged&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;linters&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;*.{js,scss}&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;eslint --fix&quot;</span><span class="token punctuation">,</span> 
            <span class="token string">&quot;git add&quot;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3>方案⼆：webpack 与 ESLint集成</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 用eslint-loader，构建时检查JS规范</span>
            <span class="token string">&quot;eslint-loader&quot;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="优化命令行的构建⽇志"><a href="#优化命令行的构建⽇志" class="header-anchor">#</a> 优化命令行的构建⽇志</h3> <p>使⽤ friendly-errors-webpack-plugin，stats 设置成errors-only。</p> <ul><li>success: 构建成功的日志提示</li> <li>warning: 构建警告的⽇志提示</li> <li>error: 构建报错的日志提示（报错信息定位很准）</li></ul> <h2 id="进阶二篇"><a href="#进阶二篇" class="header-anchor">#</a> 进阶二篇</h2> <h3 id="速度分析"><a href="#速度分析" class="header-anchor">#</a> 速度分析</h3> <p>使用 speed-measure-webpack-plugin 可以看到每个 loader 和插件执行耗时，以有利于我们针对打包速度去做优化。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> SpeedMeasurePlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;speed-measure-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> smp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpeedMeasurePlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">MyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">MyOtherPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><a href="https://github.com/stephencookdev/speed-measure-webpack-plugin" target="_blank" rel="noopener noreferrer">具体优化方案请参考官方<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="分析体积"><a href="#分析体积" class="header-anchor">#</a> 分析体积</h3> <p>使用 webpack-bundle-analyzer 分析体积，达到针对性优化的目的(注意：<code>仅在开发环境使用</code>)。</p> <p>可以具体分析哪些问题？</p> <ul><li>依赖的第三方模块文件大小</li> <li>业务里面的组件代码大小</li></ul> <h3 id="使用高版本-webpack-和-node"><a href="#使用高版本-webpack-和-node" class="header-anchor">#</a> 使用高版本 webpack 和 Node</h3> <p>因为高版本的 webpack 和 node 内部性能提升，对 webpack 的构建效率有很大提升。</p> <h3 id="多进程-happypack"><a href="#多进程-happypack" class="header-anchor">#</a> 多进程 HappyPack</h3> <p>原理:每次 webapck 解析一个模块，HappyPack 会将这部分任务分解到多个子进程中去并行处理，子进程处理完成后把结果发送到主进程中，从而减少总的构建时间。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>exports<span class="token punctuation">.</span>plugins <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token string">'jsx'</span><span class="token punctuation">,</span>
        threads<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
        loaders<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'babel-loader'</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    
    <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token string">'styles'</span><span class="token punctuation">,</span>
        threads<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        loaders<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
exports<span class="token punctuation">.</span>module<span class="token punctuation">.</span>rules <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token string">'happypack/loader?id=jsx'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token string">'happypack/loader?id=styles'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="多进程-thread-loader"><a href="#多进程-thread-loader" class="header-anchor">#</a> 多进程 thread-loader</h3> <p>原理：每次 webpack 解析一个模块，thread- loader 会将它及它的依赖分配给 worker 线程中。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        include<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;thread-loader&quot;</span><span class="token punctuation">,</span>
                options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    workers<span class="token punctuation">:</span> <span class="token number">3</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">&quot;babel-loader&quot;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="多进程-并行压缩"><a href="#多进程-并行压缩" class="header-anchor">#</a> 多进程 并行压缩</h3> <p>方法一：uglifyjs-webpack-plugin 开启 parallel 参数。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            cache<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>      <span class="token comment">// 启用 缓存</span>
            parallel<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>   <span class="token comment">// 启用 多进程并行运行。</span>
            sourceMap<span class="token punctuation">:</span> <span class="token boolean">true</span>   <span class="token comment">// 使用源映射将错误消息位置映射到模块。主要用来定位bug。</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>方法二： terser-webpack-plugin 开启 parallel 参数。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    minimize<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            parallel<span class="token punctuation">:</span> <span class="token number">4</span>  <span class="token comment">// 平行4个进程</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="缓存"><a href="#缓存" class="header-anchor">#</a> 缓存</h3> <p>目的：提升二次构建速度。</p> <p>缓存思路:</p> <ul><li>babel-loader 开启缓存</li> <li>terser-webpack-plugin 开启缓存</li> <li>使用 cache-loader 或者 hard-source-webpack-plugin</li></ul> <h3 id="缩小构建目标"><a href="#缩小构建目标" class="header-anchor">#</a> 缩小构建目标</h3> <p>目的：尽可能的少构建模块。</p> <p>比如 babel-loader 通过 exclude 不解析 node_modules。</p> <h3 id="减少文件搜索范围"><a href="#减少文件搜索范围" class="header-anchor">#</a> 减少文件搜索范围</h3> <p>alias：配置别名可以加快webpack查找模块的速度。</p> <p>extension：指定 extension 之后可以不用在 require 或是 import 的时候加文件扩展名，会依次尝试添加扩展名进行匹配。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    extension<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.jsx&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;@&quot;</span><span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      pages<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src/pages&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      router<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src/router&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="图片压缩"><a href="#图片压缩" class="header-anchor">#</a> 图片压缩</h3> <p>使用：image-webpack-loader。</p> <p>优点：有很多定制选项，可以引入更多第三方优化插件，例如pngquant，可以处理多种图片格式。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>rules<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> <span class="token regex">/\.(gif|png|jpe?g|svg)$/i</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'image-webpack-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                mozjpeg<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    progressive<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    quality<span class="token punctuation">:</span> <span class="token number">65</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">// optipng.enabled: false will disable optipng</span>
                optipng<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    enabled<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                pngquant<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    quality<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.65</span><span class="token punctuation">,</span> <span class="token number">0.90</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    speed<span class="token punctuation">:</span> <span class="token number">4</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                gifsicle<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    interlaced<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">// the webp option will enable WEBP</span>
                webp<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    quality<span class="token punctuation">:</span> <span class="token number">75</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="提升体验"><a href="#提升体验" class="header-anchor">#</a> 提升体验</h2> <p>这里主要是介绍几款 webpack 插件来帮助大家提升构建体验，虽然说它们在提升构建效率上对你没有什么太大的帮助，但能让你在等待构建完成的过程中更加舒服。</p> <h3 id="progress-bar-webpack-plugin"><a href="#progress-bar-webpack-plugin" class="header-anchor">#</a> <a href="https://www.npmjs.com/package/progress-bar-webpack-plugin" target="_blank" rel="noopener noreferrer">progress-bar-webpack-plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm i <span class="token operator">-</span><span class="token constant">D</span> progress<span class="token operator">-</span>bar<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin

<span class="token comment">// webpack.prod.js</span>
<span class="token keyword">const</span> ProgressBarPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'progress-bar-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token operator">...</span>
plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">ProgressBarPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>效果如下图所示：</p> <p><img src="https://t1.picb.cc/uploads/2019/09/18/gFD34t.jpg" alt="gFD34t.jpg"></p> <h3 id="webpack-build-notifier"><a href="#webpack-build-notifier" class="header-anchor">#</a> <a href="https://www.npmjs.com/package/webpack-build-notifier" target="_blank" rel="noopener noreferrer">webpack-build-notifier<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h3> <p>这是一款在你构建完成时，能够像微信、Lark这样的APP弹出消息的方式，提示你构建已经完成了。也就是说，当你启动构建时，就可以隐藏控制台面板，专心去做其他事情啦，到“点”了自然会来叫你，它的效果就是下面这样，同时还有提示音噢～</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install webpack<span class="token operator">-</span>build<span class="token operator">-</span>notifier <span class="token operator">-</span><span class="token constant">D</span>

<span class="token comment">// webpack.prod.js</span>
<span class="token keyword">const</span> WebpackBuildNotifierPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-build-notifier'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span> 
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">WebpackBuildNotifierPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            title<span class="token punctuation">:</span> <span class="token string">'张芳朝 请注意 打包'</span><span class="token punctuation">,</span> <span class="token comment">// 提示信息</span>
            logo<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./static/test.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 提示图片</span>
            suppressSuccess<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>效果如下图所示：</p> <p><img src="https://t1.picb.cc/uploads/2019/09/18/gFDblJ.jpg" alt="gFDblJ.jpg"></p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>革命尚未成功，同志仍需努力。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2020-2-22 6:18:31 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/base/git.html" class="prev">工具 Git</a></span> <span class="next"><a href="/base/wechat.html">小程序篇</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.13f7f72b.js" defer></script><script src="/assets/js/2.8bf05cb3.js" defer></script><script src="/assets/js/15.71d46fae.js" defer></script>
  </body>
</html>
